const test = require('ava')

const {circle} = require('./index')

const geom2 = require('../geometry/geom2')

const comparePoints = require('../../test/helpers/comparePoints')

test('circle (defaults)', t => {
  const geometry = circle()
  const pts = geom2.toPoints(geometry)
  const exp = [
    [ 1, 0 ],
    [ 0.9238795042037964, 0.3826834261417389 ],
    [ 0.7071067690849304, 0.7071067690849304 ],
    [ 0.3826834261417389, 0.9238795042037964 ],
    [ 6.123234262925839e-17, 1 ],
    [ -0.3826834261417389, 0.9238795042037964 ],
    [ -0.7071067690849304, 0.7071067690849304 ],
    [ -0.9238795042037964, 0.3826834261417389 ],
    [ -1, 1.2246468525851679e-16 ],
    [ -0.9238795042037964, -0.3826834261417389 ],
    [ -0.7071067690849304, -0.7071067690849304 ],
    [ -0.3826834261417389, -0.9238795042037964 ],
    [ -1.8369701465288538e-16, -1 ],
    [ 0.3826834261417389, -0.9238795042037964 ],
    [ 0.7071067690849304, -0.7071067690849304 ],
    [ 0.9238795042037964, -0.3826834261417389 ]
  ]

  t.deepEqual(pts.length, 16)
  t.true(comparePoints(pts, exp))
})

test('circle (options)', t => {
  // test radius
  let geometry = circle({radius: 3.5})
  let pts = geom2.toPoints(geometry)
  let exp = [
    [ 3.5, 0 ],
    [ 3.2335784435272217, 1.339392066001892 ],
    [ 2.4748737812042236, 2.4748737812042236 ],
    [ 1.339392066001892, 3.2335784435272217 ],
    [ 0, 3.5 ],
    [ -1.339392066001892, 3.2335784435272217 ],
    [ -2.4748737812042236, 2.4748737812042236 ],
    [ -3.2335784435272217, 1.339392066001892 ],
    [ -3.5, 4.2862638516991895e-16 ],
    [ -3.2335784435272217, -1.339392066001892 ],
    [ -2.4748737812042236, -2.4748737812042236 ],
    [ -1.339392066001892, -3.2335784435272217 ],
    [ -6.429395645199886e-16, -3.5 ],
    [ 1.339392066001892, -3.2335784435272217 ],
    [ 2.4748737812042236, -2.4748737812042236 ],
    [ 3.2335784435272217, -1.339392066001892 ]
  ]

  t.deepEqual(pts.length, 16)
  t.true(comparePoints(pts, exp))

  // test center
  geometry = circle({radius: 3.5, center: [6.5, 6.5]})
  pts = geom2.toPoints(geometry)
  exp = [
    [ 10, 6.5 ],
    [ 9.7335786819458, 7.839392185211182 ],
    [ 8.974873542785645, 8.974873542785645 ],
    [ 7.839392185211182, 9.7335786819458 ],
    [ 6.5, 10 ],
    [ 5.160607814788818, 9.7335786819458 ],
    [ 4.0251264572143555, 8.974873542785645 ],
    [ 3.2664215564727783, 7.839392185211182 ],
    [ 3, 6.5 ],
    [ 3.2664215564727783, 5.160607814788818 ],
    [ 4.0251264572143555, 4.0251264572143555 ],
    [ 5.160607814788818, 3.2664215564727783 ],
    [ 6.5, 3 ],
    [ 7.839392185211182, 3.2664215564727783 ],
    [ 8.974873542785645, 4.0251264572143555 ],
    [ 9.7335786819458, 5.160607814788818 ]
  ]

  t.deepEqual(pts.length, 16)
  t.true(comparePoints(pts, exp))

  // test segments
  geometry = circle({radius: 3.5, center: [6.5, 6.5], segments: 5})
  pts = geom2.toPoints(geometry)
  exp = [
    [ 10, 6.5 ],
    [ 7.581559658050537, 9.82869815826416 ],
    [ 3.668440580368042, 8.55724811553955 ],
    [ 3.668440580368042, 4.442751884460449 ],
    [ 7.581559658050537, 3.171302080154419 ]
  ]

  t.deepEqual(pts.length, 5)
  t.true(comparePoints(pts, exp))
})
